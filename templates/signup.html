<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign Up - Trucking Pilot Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn { from {opacity:0; transform: translateY(12px)} to {opacity:1; transform: translateY(0)} }
    .fade-in { animation: fadeIn .4s ease-out }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .glass-effect { background: rgba(255,255,255,.95); backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(31,38,135,.15); }
    .password-strength { height: 4px; background: #e5e7eb; border-radius: 2px; margin-top: 8px; overflow: hidden; }
    .password-strength-bar { height: 100%; transition: all .3s ease; }
    .step-dot { width: 28px; height: 28px }
    .step-active { background: linear-gradient(90deg,#7c3aed,#6366f1); color: #fff; }
    .step-complete { background: #10b981; color: #fff; }
    .step-pending { background: #e5e7eb; color:#6b7280; }
  </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center py-10 px-4 sm:px-6 lg:px-8">
  <div class="max-w-3xl w-full space-y-6 fade-in">
    <div class="glass-effect rounded-2xl p-4 md:p-6">
      <!-- Header -->
      <div class="flex items-center gap-3 mb-4">
        <div class="h-12 w-12 rounded-full bg-gradient-to-r from-purple-600 to-indigo-600 grid place-items-center">
          <svg class="h-7 w-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
          </svg>
        </div>
        <div>
          <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Create Account</h1>
          <p class="text-sm text-gray-500">Start automating your workflows today</p>
        </div>
      </div>

      <!-- Flash Messages -->
      {% if messages %}
        {% for message in messages %}
          <div class="mb-4 p-4 rounded-lg {% if message.tags == 'error' %}bg-red-50 text-red-800{% elif message.tags == 'success' %}bg-green-50 text-green-800{% else %}bg-blue-50 text-blue-800{% endif %}">
            <p class="text-sm">{{ message }}</p>
          </div>
        {% endfor %}
      {% endif %}

      <!-- Stepper -->
      <div class="sticky top-4 z-10 bg-white/70 backdrop-blur rounded-xl border border-gray-100 p-3 mb-5 hidden md:block">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div id="dot-1" class="step-dot rounded-full grid place-items-center step-active">1</div>
            <span class="text-sm font-medium" id="label-1">Personal</span>
          </div>
          <div class="h-1 flex-1 mx-4 bg-gray-200 rounded-full overflow-hidden">
            <div id="progress" class="h-1 w-1/3 bg-gradient-to-r from-purple-600 to-indigo-600 transition-all duration-300"></div>
          </div>
          <div class="flex items-center gap-3">
            <div id="dot-2" class="step-dot rounded-full grid place-items-center step-pending">2</div>
            <span class="text-sm font-medium" id="label-2">Company</span>
          </div>
          <div class="flex items-center gap-3">
            <div id="dot-3" class="step-dot rounded-full grid place-items-center step-pending">3</div>
            <span class="text-sm font-medium" id="label-3">Security</span>
          </div>
        </div>
      </div>

      <!-- Form -->
      <form id="signup-form" class="mt-2 space-y-6" method="POST" action="{% url 'signup' %}">
        {% csrf_token %}

        <!-- Step 1: Personal -->
        <section id="step-1" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="first_name" class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
              <input id="first_name" name="first_name" type="text" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="John">
            </div>
            <div>
              <label for="last_name" class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
              <input id="last_name" name="last_name" type="text" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="Doe">
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
              <input id="email" name="email" type="email" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="john.doe@example.com">
            </div>
            <div>
              <label for="phone_number" class="block text-sm font-medium text-gray-700 mb-2">
                Phone Number
              </label>
            
              <div class="flex gap-2">
                <!-- COUNTRY CODE DROPDOWN -->
                <select id="country_code" name="country_code"
                  class="px-4 py-3 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent w-32">
                  <option value="+93">ğŸ‡¦ğŸ‡« Afghanistan (+93)</option>
                  <option value="+355">ğŸ‡¦ğŸ‡± Albania (+355)</option>
                  <option value="+213">ğŸ‡©ğŸ‡¿ Algeria (+213)</option>
                  <option value="+1 684">ğŸ‡¦ğŸ‡¸ American Samoa (+1 684)</option>
                  <option value="+376">ğŸ‡¦ğŸ‡© Andorra (+376)</option>
                  <option value="+244">ğŸ‡¦ğŸ‡´ Angola (+244)</option>
                  <option value="+1 264">ğŸ‡¦ğŸ‡® Anguilla (+1 264)</option>
                  <option value="+672">ğŸ‡¦ğŸ‡¶ Antarctica (+672)</option>
                  <option value="+1 268">ğŸ‡¦ğŸ‡¬ Antigua and Barbuda (+1 268)</option>
                  <option value="+54">ğŸ‡¦ğŸ‡· Argentina (+54)</option>
                  <option value="+374">ğŸ‡¦ğŸ‡² Armenia (+374)</option>
                  <option value="+297">ğŸ‡¦ğŸ‡¼ Aruba (+297)</option>
                  <option value="+61">ğŸ‡¦ğŸ‡º Australia (+61)</option>
                  <option value="+43">ğŸ‡¦ğŸ‡¹ Austria (+43)</option>
                  <option value="+994">ğŸ‡¦ğŸ‡¿ Azerbaijan (+994)</option>

                  <option value="+1 242">ğŸ‡§ğŸ‡¸ Bahamas (+1 242)</option>
                  <option value="+973">ğŸ‡§ğŸ‡­ Bahrain (+973)</option>
                  <option value="+880">ğŸ‡§ğŸ‡© Bangladesh (+880)</option>
                  <option value="+1 246">ğŸ‡§ğŸ‡§ Barbados (+1 246)</option>
                  <option value="+375">ğŸ‡§ğŸ‡¾ Belarus (+375)</option>
                  <option value="+32">ğŸ‡§ğŸ‡ª Belgium (+32)</option>
                  <option value="+501">ğŸ‡§ğŸ‡¿ Belize (+501)</option>
                  <option value="+229">ğŸ‡§ğŸ‡¯ Benin (+229)</option>
                  <option value="+1 441">ğŸ‡§ğŸ‡² Bermuda (+1 441)</option>
                  <option value="+975">ğŸ‡§ğŸ‡¹ Bhutan (+975)</option>
                  <option value="+591">ğŸ‡§ğŸ‡´ Bolivia (+591)</option>
                  <option value="+387">ğŸ‡§ğŸ‡¦ Bosnia and Herzegovina (+387)</option>
                  <option value="+267">ğŸ‡§ğŸ‡¼ Botswana (+267)</option>
                  <option value="+55">ğŸ‡§ğŸ‡· Brazil (+55)</option>
                  <option value="+246">ğŸ‡®ğŸ‡´ British Indian Ocean Territory (+246)</option>
                  <option value="+1 284">ğŸ‡»ğŸ‡¬ British Virgin Islands (+1 284)</option>
                  <option value="+673">ğŸ‡§ğŸ‡³ Brunei (+673)</option>
                  <option value="+359">ğŸ‡§ğŸ‡¬ Bulgaria (+359)</option>
                  <option value="+226">ğŸ‡§ğŸ‡« Burkina Faso (+226)</option>
                  <option value="+257">ğŸ‡§ğŸ‡® Burundi (+257)</option>

                  <option value="+855">ğŸ‡°ğŸ‡­ Cambodia (+855)</option>
                  <option value="+237">ğŸ‡¨ğŸ‡² Cameroon (+237)</option>
                  <option value="+1">ğŸ‡¨ğŸ‡¦ Canada (+1)</option>
                  <option value="+238">ğŸ‡¨ğŸ‡» Cape Verde (+238)</option>
                  <option value="+1 345">ğŸ‡°ğŸ‡¾ Cayman Islands (+1 345)</option>
                  <option value="+236">ğŸ‡¨ğŸ‡« Central African Republic (+236)</option>
                  <option value="+235">ğŸ‡¹ğŸ‡© Chad (+235)</option>
                  <option value="+56">ğŸ‡¨ğŸ‡± Chile (+56)</option>
                  <option value="+86">ğŸ‡¨ğŸ‡³ China (+86)</option>
                  <option value="+61">ğŸ‡¨ğŸ‡½ Christmas Island (+61)</option>
                  <option value="+61">ğŸ‡¨ğŸ‡¨ Cocos Islands (+61)</option>
                  <option value="+57">ğŸ‡¨ğŸ‡´ Colombia (+57)</option>
                  <option value="+269">ğŸ‡°ğŸ‡² Comoros (+269)</option>
                  <option value="+682">ğŸ‡¨ğŸ‡° Cook Islands (+682)</option>
                  <option value="+506">ğŸ‡¨ğŸ‡· Costa Rica (+506)</option>
                  <option value="+385">ğŸ‡­ğŸ‡· Croatia (+385)</option>
                  <option value="+53">ğŸ‡¨ğŸ‡º Cuba (+53)</option>
                  <option value="+599">ğŸ‡¨ğŸ‡¼ CuraÃ§ao (+599)</option>
                  <option value="+357">ğŸ‡¨ğŸ‡¾ Cyprus (+357)</option>
                  <option value="+420">ğŸ‡¨ğŸ‡¿ Czechia (+420)</option>

                  <option value="+243">ğŸ‡¨ğŸ‡© DR Congo (+243)</option>
                  <option value="+45">ğŸ‡©ğŸ‡° Denmark (+45)</option>
                  <option value="+253">ğŸ‡©ğŸ‡¯ Djibouti (+253)</option>
                  <option value="+1 767">ğŸ‡©ğŸ‡² Dominica (+1 767)</option>
                  <option value="+1 809">ğŸ‡©ğŸ‡´ Dominican Republic (+1 809)</option>

                  <option value="+670">ğŸ‡¹ğŸ‡± East Timor (+670)</option>
                  <option value="+593">ğŸ‡ªğŸ‡¨ Ecuador (+593)</option>
                  <option value="+20">ğŸ‡ªğŸ‡¬ Egypt (+20)</option>
                  <option value="+503">ğŸ‡¸ğŸ‡» El Salvador (+503)</option>
                  <option value="+240">ğŸ‡¬ğŸ‡¶ Equatorial Guinea (+240)</option>
                  <option value="+291">ğŸ‡ªğŸ‡· Eritrea (+291)</option>
                  <option value="+372">ğŸ‡ªğŸ‡ª Estonia (+372)</option>
                  <option value="+268">ğŸ‡¸ğŸ‡¿ Eswatini (+268)</option>
                  <option value="+251">ğŸ‡ªğŸ‡¹ Ethiopia (+251)</option>

                  <option value="+500">ğŸ‡«ğŸ‡° Falkland Islands (+500)</option>
                  <option value="+298">ğŸ‡«ğŸ‡´ Faroe Islands (+298)</option>
                  <option value="+679">ğŸ‡«ğŸ‡¯ Fiji (+679)</option>
                  <option value="+358">ğŸ‡«ğŸ‡® Finland (+358)</option>
                  <option value="+33">ğŸ‡«ğŸ‡· France (+33)</option>
                  <option value="+594">ğŸ‡¬ğŸ‡« French Guiana (+594)</option>
                  <option value="+689">ğŸ‡µğŸ‡« French Polynesia (+689)</option>

                  <option value="+241">ğŸ‡¬ğŸ‡¦ Gabon (+241)</option>
                  <option value="+220">ğŸ‡¬ğŸ‡² Gambia (+220)</option>
                  <option value="+995">ğŸ‡¬ğŸ‡ª Georgia (+995)</option>
                  <option value="+49">ğŸ‡©ğŸ‡ª Germany (+49)</option>
                  <option value="+233">ğŸ‡¬ğŸ‡­ Ghana (+233)</option>
                  <option value="+350">ğŸ‡¬ğŸ‡® Gibraltar (+350)</option>
                  <option value="+30">ğŸ‡¬ğŸ‡· Greece (+30)</option>
                  <option value="+299">ğŸ‡¬ğŸ‡± Greenland (+299)</option>
                  <option value="+1 473">ğŸ‡¬ğŸ‡© Grenada (+1 473)</option>
                  <option value="+590">ğŸ‡¬ğŸ‡µ Guadeloupe (+590)</option>
                  <option value="+1 671">ğŸ‡¬ğŸ‡º Guam (+1 671)</option>
                  <option value="+502">ğŸ‡¬ğŸ‡¹ Guatemala (+502)</option>
                  <option value="+44">ğŸ‡¬ğŸ‡¬ Guernsey (+44)</option>
                  <option value="+224">ğŸ‡¬ğŸ‡³ Guinea (+224)</option>
                  <option value="+245">ğŸ‡¬ğŸ‡¼ Guinea-Bissau (+245)</option>
                  <option value="+592">ğŸ‡¬ğŸ‡¾ Guyana (+592)</option>

                  <option value="+509">ğŸ‡­ğŸ‡¹ Haiti (+509)</option>
                  <option value="+504">ğŸ‡­ğŸ‡³ Honduras (+504)</option>
                  <option value="+852">ğŸ‡­ğŸ‡° Hong Kong (+852)</option>
                  <option value="+36">ğŸ‡­ğŸ‡º Hungary (+36)</option>

                  <option value="+354">ğŸ‡®ğŸ‡¸ Iceland (+354)</option>
                  <option value="+91">ğŸ‡®ğŸ‡³ India (+91)</option>
                  <option value="+62">ğŸ‡®ğŸ‡© Indonesia (+62)</option>
                  <option value="+98">ğŸ‡®ğŸ‡· Iran (+98)</option>
                  <option value="+964">ğŸ‡®ğŸ‡¶ Iraq (+964)</option>
                  <option value="+353">ğŸ‡®ğŸ‡ª Ireland (+353)</option>
                  <option value="+44">ğŸ‡®ğŸ‡² Isle of Man (+44)</option>
                  <option value="+972">ğŸ‡®ğŸ‡± Israel (+972)</option>
                  <option value="+39">ğŸ‡®ğŸ‡¹ Italy (+39)</option>

                  <option value="+1 876">ğŸ‡¯ğŸ‡² Jamaica (+1 876)</option>
                  <option value="+81">ğŸ‡¯ğŸ‡µ Japan (+81)</option>
                  <option value="+44">ğŸ‡¯ğŸ‡ª Jersey (+44)</option>
                  <option value="+962">ğŸ‡¯ğŸ‡´ Jordan (+962)</option>

                  <option value="+7">ğŸ‡°ğŸ‡¿ Kazakhstan (+7)</option>
                  <option value="+254">ğŸ‡°ğŸ‡ª Kenya (+254)</option>
                  <option value="+686">ğŸ‡°ğŸ‡® Kiribati (+686)</option>
                  <option value="+383">ğŸ‡½ğŸ‡° Kosovo (+383)</option>
                  <option value="+965">ğŸ‡°ğŸ‡¼ Kuwait (+965)</option>
                  <option value="+996">ğŸ‡°ğŸ‡¬ Kyrgyzstan (+996)</option>

                  <option value="+856">ğŸ‡±ğŸ‡¦ Laos (+856)</option>
                  <option value="+371">ğŸ‡±ğŸ‡» Latvia (+371)</option>
                  <option value="+961">ğŸ‡±ğŸ‡§ Lebanon (+961)</option>
                  <option value="+266">ğŸ‡±ğŸ‡¸ Lesotho (+266)</option>
                  <option value="+231">ğŸ‡±ğŸ‡· Liberia (+231)</option>
                  <option value="+218">ğŸ‡±ğŸ‡¾ Libya (+218)</option>
                  <option value="+423">ğŸ‡±ğŸ‡® Liechtenstein (+423)</option>
                  <option value="+370">ğŸ‡±ğŸ‡¹ Lithuania (+370)</option>
                  <option value="+352">ğŸ‡±ğŸ‡º Luxembourg (+352)</option>

                  <option value="+853">ğŸ‡²ğŸ‡´ Macau (+853)</option>
                  <option value="+389">ğŸ‡²ğŸ‡° North Macedonia (+389)</option>
                  <option value="+261">ğŸ‡²ğŸ‡¬ Madagascar (+261)</option>
                  <option value="+265">ğŸ‡²ğŸ‡¼ Malawi (+265)</option>
                  <option value="+60">ğŸ‡²ğŸ‡¾ Malaysia (+60)</option>
                  <option value="+960">ğŸ‡²ğŸ‡» Maldives (+960)</option>
                  <option value="+223">ğŸ‡²ğŸ‡± Mali (+223)</option>
                  <option value="+356">ğŸ‡²ğŸ‡¹ Malta (+356)</option>
                  <option value="+692">ğŸ‡²ğŸ‡­ Marshall Islands (+692)</option>
                  <option value="+596">ğŸ‡²ğŸ‡¶ Martinique (+596)</option>
                  <option value="+222">ğŸ‡²ğŸ‡· Mauritania (+222)</option>
                  <option value="+230">ğŸ‡²ğŸ‡º Mauritius (+230)</option>
                  <option value="+262">ğŸ‡¾ğŸ‡¹ Mayotte (+262)</option>
                  <option value="+52">ğŸ‡²ğŸ‡½ Mexico (+52)</option>
                  <option value="+691">ğŸ‡«ğŸ‡² Micronesia (+691)</option>
                  <option value="+373">ğŸ‡²ğŸ‡© Moldova (+373)</option>
                  <option value="+377">ğŸ‡²ğŸ‡¨ Monaco (+377)</option>
                  <option value="+976">ğŸ‡²ğŸ‡³ Mongolia (+976)</option>
                  <option value="+382">ğŸ‡²ğŸ‡ª Montenegro (+382)</option>
                  <option value="+1 664">ğŸ‡²ğŸ‡¸ Montserrat (+1 664)</option>
                  <option value="+212">ğŸ‡²ğŸ‡¦ Morocco (+212)</option>
                  <option value="+258">ğŸ‡²ğŸ‡¿ Mozambique (+258)</option>

                  <option value="+95">ğŸ‡²ğŸ‡² Myanmar (+95)</option>

                  <option value="+264">ğŸ‡³ğŸ‡¦ Namibia (+264)</option>
                  <option value="+674">ğŸ‡³ğŸ‡· Nauru (+674)</option>
                  <option value="+977">ğŸ‡³ğŸ‡µ Nepal (+977)</option>
                  <option value="+31">ğŸ‡³ğŸ‡± Netherlands (+31)</option>
                  <option value="+687">ğŸ‡³ğŸ‡¨ New Caledonia (+687)</option>
                  <option value="+64">ğŸ‡³ğŸ‡¿ New Zealand (+64)</option>
                  <option value="+505">ğŸ‡³ğŸ‡® Nicaragua (+505)</option>
                  <option value="+227">ğŸ‡³ğŸ‡ª Niger (+227)</option>
                  <option value="+234">ğŸ‡³ğŸ‡¬ Nigeria (+234)</option>
                  <option value="+683">ğŸ‡³ğŸ‡º Niue (+683)</option>
                  <option value="+672">ğŸ‡³ğŸ‡« Norfolk Island (+672)</option>
                  <option value="+850">ğŸ‡°ğŸ‡µ North Korea (+850)</option>
                  <option value="+1 670">ğŸ‡²ğŸ‡µ Northern Mariana Islands (+1 670)</option>
                  <option value="+47">ğŸ‡³ğŸ‡´ Norway (+47)</option>

                  <option value="+968">ğŸ‡´ğŸ‡² Oman (+968)</option>

                  <option value="+92">ğŸ‡µğŸ‡° Pakistan (+92)</option>
                  <option value="+680">ğŸ‡µğŸ‡¼ Palau (+680)</option>
                  <option value="+970">ğŸ‡µğŸ‡¸ Palestine (+970)</option>
                  <option value="+507">ğŸ‡µğŸ‡¦ Panama (+507)</option>
                  <option value="+675">ğŸ‡µğŸ‡¬ Papua New Guinea (+675)</option>
                  <option value="+595">ğŸ‡µğŸ‡¾ Paraguay (+595)</option>
                  <option value="+51">ğŸ‡µğŸ‡ª Peru (+51)</option>
                  <option value="+63">ğŸ‡µğŸ‡­ Philippines (+63)</option>
                  <option value="+48">ğŸ‡µğŸ‡± Poland (+48)</option>
                  <option value="+351">ğŸ‡µğŸ‡¹ Portugal (+351)</option>
                  <option value="+1 787">ğŸ‡µğŸ‡· Puerto Rico (+1 787)</option>

                  <option value="+974">ğŸ‡¶ğŸ‡¦ Qatar (+974)</option>

                  <option value="+242">ğŸ‡¨ğŸ‡¬ Republic of the Congo (+242)</option>
                  <option value="+40">ğŸ‡·ğŸ‡´ Romania (+40)</option>
                  <option value="+7">ğŸ‡·ğŸ‡º Russia (+7)</option>
                  <option value="+250">ğŸ‡·ğŸ‡¼ Rwanda (+250)</option>

                  <option value="+590">ğŸ‡§ğŸ‡± Saint BarthÃ©lemy (+590)</option>
                  <option value="+290">ğŸ‡¸ğŸ‡­ Saint Helena (+290)</option>
                  <option value="+1 869">ğŸ‡°ğŸ‡³ Saint Kitts and Nevis (+1 869)</option>
                  <option value="+1 758">ğŸ‡±ğŸ‡¨ Saint Lucia (+1 758)</option>
                  <option value="+590">ğŸ‡²ğŸ‡« Saint Martin (+590)</option>
                  <option value="+508">ğŸ‡µğŸ‡² Saint Pierre and Miquelon (+508)</option>
                  <option value="+1 784">ğŸ‡»ğŸ‡¨ Saint Vincent and the Grenadines (+1 784)</option>

                  <option value="+685">ğŸ‡¼ğŸ‡¸ Samoa (+685)</option>
                  <option value="+378">ğŸ‡¸ğŸ‡² San Marino (+378)</option>
                  <option value="+239">ğŸ‡¸ğŸ‡¹ Sao Tome and Principe (+239)</option>
                  <option value="+966">ğŸ‡¸ğŸ‡¦ Saudi Arabia (+966)</option>
                  <option value="+221">ğŸ‡¸ğŸ‡³ Senegal (+221)</option>
                  <option value="+381">ğŸ‡·ğŸ‡¸ Serbia (+381)</option>
                  <option value="+248">ğŸ‡¸ğŸ‡¨ Seychelles (+248)</option>
                  <option value="+232">ğŸ‡¸ğŸ‡± Sierra Leone (+232)</option>
                  <option value="+65">ğŸ‡¸ğŸ‡¬ Singapore (+65)</option>
                  <option value="+421">ğŸ‡¸ğŸ‡° Slovakia (+421)</option>
                  <option value="+386">ğŸ‡¸ğŸ‡® Slovenia (+386)</option>
                  <option value="+677">ğŸ‡¸ğŸ‡§ Solomon Islands (+677)</option>
                  <option value="+252">ğŸ‡¸ğŸ‡´ Somalia (+252)</option>
                  <option value="+27">ğŸ‡¿ğŸ‡¦ South Africa (+27)</option>
                  <option value="+82">ğŸ‡°ğŸ‡· South Korea (+82)</option>
                  <option value="+211">ğŸ‡¸ğŸ‡¸ South Sudan (+211)</option>
                  <option value="+34">ğŸ‡ªğŸ‡¸ Spain (+34)</option>
                  <option value="+94">ğŸ‡±ğŸ‡° Sri Lanka (+94)</option>
                  <option value="+249">ğŸ‡¸ğŸ‡© Sudan (+249)</option>
                  <option value="+597">ğŸ‡¸ğŸ‡· Suriname (+597)</option>
                  <option value="+47">ğŸ‡¸ğŸ‡¯ Svalbard and Jan Mayen (+47)</option>
                  <option value="+46">ğŸ‡¸ğŸ‡ª Sweden (+46)</option>
                  <option value="+41">ğŸ‡¨ğŸ‡­ Switzerland (+41)</option>
                  <option value="+963">ğŸ‡¸ğŸ‡¾ Syria (+963)</option>

                  <option value="+886">ğŸ‡¹ğŸ‡¼ Taiwan (+886)</option>
                  <option value="+992">ğŸ‡¹ğŸ‡¯ Tajikistan (+992)</option>
                  <option value="+255">ğŸ‡¹ğŸ‡¿ Tanzania (+255)</option>
                  <option value="+66">ğŸ‡¹ğŸ‡­ Thailand (+66)</option>
                  <option value="+1 868">ğŸ‡¹ğŸ‡¹ Trinidad and Tobago (+1 868)</option>
                  <option value="+216">ğŸ‡¹ğŸ‡³ Tunisia (+216)</option>
                  <option value="+90">ğŸ‡¹ğŸ‡· TÃ¼rkiye (+90)</option>
                  <option value="+993">ğŸ‡¹ğŸ‡² Turkmenistan (+993)</option>
                  <option value="+1 649">ğŸ‡¹ğŸ‡¨ Turks and Caicos Islands (+1 649)</option>
                  <option value="+688">ğŸ‡¹ğŸ‡» Tuvalu (+688)</option>

                  <option value="+256">ğŸ‡ºğŸ‡¬ Uganda (+256)</option>
                  <option value="+380">ğŸ‡ºğŸ‡¦ Ukraine (+380)</option>
                  <option value="+971">ğŸ‡¦ğŸ‡ª United Arab Emirates (+971)</option>
                  <option value="+44">ğŸ‡¬ğŸ‡§ United Kingdom (+44)</option>
                  <option value="+1">ğŸ‡ºğŸ‡¸ United States (+1)</option>
                  <option value="+598">ğŸ‡ºğŸ‡¾ Uruguay (+598)</option>
                  <option value="+998">ğŸ‡ºğŸ‡¿ Uzbekistan (+998)</option>

                  <option value="+678">ğŸ‡»ğŸ‡º Vanuatu (+678)</option>
                  <option value="+379">ğŸ‡»ğŸ‡¦ Vatican City (+379)</option>
                  <option value="+58">ğŸ‡»ğŸ‡ª Venezuela (+58)</option>
                  <option value="+84">ğŸ‡»ğŸ‡³ Vietnam (+84)</option>

                  <option value="+681">ğŸ‡¼ğŸ‡« Wallis and Futuna (+681)</option>
                  <option value="+212">ğŸ‡ªğŸ‡­ Western Sahara (+212)</option>

                  <option value="+967">ğŸ‡¾ğŸ‡ª Yemen (+967)</option>

                  <option value="+260">ğŸ‡¿ğŸ‡² Zambia (+260)</option>
                  <option value="+263">ğŸ‡¿ğŸ‡¼ Zimbabwe (+263)</option>

                  <!-- Add more if needed -->
                </select>
            
                <!-- PHONE INPUT FIELD -->
                <input id="phone_number" name="phone_number" type="tel" required
                  class="flex-1 px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  placeholder="Phone number without country code">
              </div>
            </div>
            
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="username" class="block text-sm font-medium text-gray-700 mb-2">Username</label>
              <input id="username" name="username" type="text" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="Choose a username">
            </div>
          </div>
        </section>

        <!-- Step 2: Company -->
        <section id="step-2" class="space-y-4 hidden">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="company_name" class="block text-sm font-medium text-gray-700 mb-2">Company Name</label>
              <input id="company_name" name="company_name" type="text" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="Acme Logistics LLC">
            </div>
            <div>
              <label for="mc_number" class="block text-sm font-medium text-gray-700 mb-2">MC Number</label>
              <input
                id="mc_number"
                name="mc_number"
                type="text"
                inputmode="numeric"
                pattern="(MC-)?\d{1,9}"
                title="Optional 'MC-' prefix, followed by 6â€“7 digits (e.g., MC-123456 or 123456)"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="MC-123456 or 123456"
              >
              <p id="mc-hint" class="mt-1 text-xs text-gray-500">Format: optional <span class="font-medium">MC-</span> and 6â€“7 digits (e.g., MC-123456).</p>
            </div>
            
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="number_of_trucks" class="block text-sm font-medium text-gray-700 mb-2">Number of Trucks</label>
              <input id="number_of_trucks" name="number_of_trucks" type="number" min="1" step="1" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="e.g., 12">
            </div>
          </div>
        </section>

        <!-- Step 3: Security -->
        <section id="step-3" class="space-y-4 hidden">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
              <input id="password" name="password" type="password" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="Create a strong password" onkeyup="checkPasswordStrength()">
              <div class="password-strength">
                <div id="strength-bar" class="password-strength-bar" style="width: 0%; background: #e5e7eb;"></div>
              </div>
              <p id="strength-text" class="text-xs text-gray-500 mt-1">Password strength: None</p>
            </div>

            <div>
              <label for="password_confirm" class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label>
              <input id="password_confirm" name="password_confirm" type="password" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                placeholder="Confirm your password">
              <p id="match-hint" class="text-xs mt-1 text-gray-400">Must match your password.</p>
            </div>
          </div>

          <div class="flex items-start">
            <div class="flex items-center h-5">
              <input id="terms" name="terms" type="checkbox" required
                class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer">
            </div>
            <div class="ml-2 text-sm">
              <label for="terms" class="text-gray-600 cursor-pointer">
                I agree to the
                <a href="#" class="text-purple-600 hover:text-purple-500 font-medium">Terms of Service</a>
                and
                <a href="#" class="text-purple-600 hover:text-purple-500 font-medium">Privacy Policy</a>
              </label>
            </div>
          </div>
        </section>

        <!-- Navigation Buttons -->
        <div class="flex items-center justify-between pt-2">
          <button type="button" id="back-btn"
                  class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-40"
                  disabled>
            â† Back
          </button>

          <div class="flex gap-2">
            <button type="button" id="next-btn"
                    class="px-5 py-2.5 rounded-lg text-white font-semibold bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
              Next
            </button>
            <button type="submit" id="submit-btn"
                    class="hidden px-5 py-2.5 rounded-lg text-white font-semibold bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
              Create Account
            </button>
          </div>
        </div>

        <p class="text-center text-sm text-gray-500 mt-4 md:mt-2">
          Already have an account?
          <a href="{% url 'login' %}" class="font-medium text-purple-600 hover:text-purple-500">Sign in</a>
        </p>
      </form>
    </div>

    <div class="text-center">
      <p class="text-sm text-white/80">&copy; 2025 Automation Platform. All rights reserved.</p>
    </div>
  </div>

  <script>
    // --- Wizard Logic ---
    const steps = ["step-1","step-2","step-3"];
    let current = 0;

    const progress = document.getElementById('progress');
    const backBtn = document.getElementById('back-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');

    const dot1 = document.getElementById('dot-1');
    const dot2 = document.getElementById('dot-2');
    const dot3 = document.getElementById('dot-3');

    function updateDots() {
      [dot1,dot2,dot3].forEach((d,i)=>{
        d.classList.remove('step-active','step-complete','step-pending');
        if (i < current) d.classList.add('step-complete');
        else if (i === current) d.classList.add('step-active');
        else d.classList.add('step-pending');
      });
      progress.style.width = ((current+1)/steps.length*100) + '%';
    }

    function showStep(i){
      steps.forEach((id, idx)=>{
        document.getElementById(id).classList.toggle('hidden', idx !== i);
      });
      backBtn.disabled = i === 0;
      nextBtn.classList.toggle('hidden', i === steps.length - 1);
      submitBtn.classList.toggle('hidden', i !== steps.length - 1);
      current = i;
      updateDots();
      // focus first input of step
      const firstInput = document.querySelector(`#${steps[i]} input`);
      if (firstInput) firstInput.focus({preventScroll:true});
    }

    nextBtn.addEventListener('click', () => {
      if (validateCurrentStep()) showStep(Math.min(current+1, steps.length-1));
    });

    backBtn.addEventListener('click', () => showStep(Math.max(current-1, 0)));

    // Keyboard: Enter -> Next (except on submit step)
    document.getElementById('signup-form').addEventListener('keydown', (e)=>{
      if (e.key === 'Enter' && !e.shiftKey) {
        if (current < steps.length - 1) {
          e.preventDefault();
          if (validateCurrentStep()) showStep(current+1);
        }
      }
    });

    // --- Lightweight Validation per step ---
    function validateCurrentStep(){
      const fieldsByStep = {
        0: ['first_name','last_name','email','phone_number','username'],
        1: ['company_name','mc_number','number_of_trucks'],
        2: ['password','password_confirm','terms']
      };
      const ids = fieldsByStep[current] || [];
      let ok = true;
      ids.forEach(id=>{
        const el = document.getElementById(id);
        if (!el) return;
        if (el.type === 'checkbox') {
          if (!el.checked) ok = false;
        } else if (!el.value.trim()) {
          ok = false;
          el.classList.add('ring-2','ring-red-400','border-transparent');
          setTimeout(()=>el.classList.remove('ring-2','ring-red-400','border-transparent'),800);
        } else if (id === 'mc_number') {
          // Accept either "MC-123456" or "123456" (6-7 digits). Normalize to "MC-123456"
          const raw = el.value.trim();
          const mcRe = /^(?:MC-)?(\d{1,9})$/i;
          const hint = document.getElementById('mc-hint');
          if (!mcRe.test(raw)) {
            ok = false;
            el.classList.add('ring-2', 'ring-red-400', 'border-transparent');
            setTimeout(() => el.classList.remove('ring-2', 'ring-red-400', 'border-transparent'), 800);
    
            if (hint) {
              hint.textContent = "Enter 'MC-' (optional) plus 6â€“7 digits (e.g., MC-123456).";
              hint.classList.add('text-red-600');
              setTimeout(() => {
                hint.textContent = "Format: optional MC- and 6â€“7 digits (e.g., MC-123456).";
                hint.classList.remove('text-red-600');
              }, 2000);
            }
          } else {
            // Normalize to consistent uppercase MC-123456
            const digits = mcRe.exec(raw)[1];
            el.value = `MC-${digits}`;
            if (hint) {
              hint.textContent = "Looks good.";
              hint.classList.remove('text-red-600');
              hint.classList.add('text-emerald-600');
              setTimeout(() => {
                hint.textContent = "Format: optional MC- and 6â€“7 digits (e.g., MC-123456).";
                hint.classList.remove('text-emerald-600');
              }, 1800);
            }
          }
        } else if (id === 'number_of_trucks' && Number(el.value) < 1) {
          el.value = 1;
        }
      });
    
      if (current === 2) {
        const p = document.getElementById('password');
        const c = document.getElementById('password_confirm');
        const hint = document.getElementById('match-hint');
        if (p.value !== c.value) {
          ok = false;
          hint.textContent = "Passwords do not match.";
          hint.className = "text-xs mt-1 text-red-600";
          c.classList.add('ring-2','ring-red-400','border-transparent');
          setTimeout(()=>c.classList.remove('ring-2','ring-red-400','border-transparent'),800);
        } else {
          hint.textContent = "Looks good.";
          hint.className = "text-xs mt-1 text-emerald-600";
        }
      }
      return ok;
    }
    

    // --- Password Strength ---
    function checkPasswordStrength() {
      const password = document.getElementById('password').value;
      const strengthBar = document.getElementById('strength-bar');
      const strengthText = document.getElementById('strength-text');
      let strength = 0, text = 'None', color = '#e5e7eb';

      if (password.length >= 8) strength++;
      if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
      if (/[0-9]/.test(password)) strength++;
      if (/[^a-zA-Z0-9]/.test(password)) strength++;

      const width = (strength * 25);
      if (strength === 0) { text='None'; color='#e5e7eb'; }
      else if (strength === 1){ text='Weak'; color='#ef4444'; }
      else if (strength === 2){ text='Fair'; color='#f59e0b'; }
      else if (strength === 3){ text='Good'; color='#3b82f6'; }
      else { text='Strong'; color='#10b981'; }

      strengthBar.style.width = width + '%';
      strengthBar.style.background = color;
      strengthText.textContent = 'Password strength: ' + text;
      strengthText.style.color = color;
    }
    window.checkPasswordStrength = checkPasswordStrength; // keep global for inline onkeyup

    // Prevent negative truck numbers
    document.getElementById('number_of_trucks')?.addEventListener('input', (e) => {
      const v = parseInt(e.target.value || '0', 10);
      if (v < 1) e.target.value = 1;
    });

    // Initialize
    showStep(0);
  </script>
  <script>
    // return only digits from a string
    function digitsOnly(s) {
      return (s || '').toString().replace(/\D+/g, '');
    }
  
    // remove common trunk prefix '0' from the local number
    function stripLeadingZero(localDigits) {
      return localDigits.replace(/^0+/, '');
    }
  
    document.getElementById('signup-form').addEventListener('submit', function (e) {
      // find elements
      const ccEl = document.getElementById('country_code');
      const phoneEl = document.getElementById('phone_number');
  
      if (!ccEl || !phoneEl) return; // nothing to do
  
      // raw values
      const rawCC = ccEl.value;            // e.g. "+91" or "+1 684"
      const rawPhone = phoneEl.value;      // e.g. "07543940627" or "(754) 394-0627"
  
      // normalize to digits
      let ccDigits = digitsOnly(rawCC);   // "+91" -> "91", "+1 684" -> "1684"
      let phoneDigits = digitsOnly(rawPhone); // "(754) 394-0627" -> "7543940627"
  
      // remove leading trunk zeros from local number (so "0754..." -> "754...")
      phoneDigits = stripLeadingZero(phoneDigits);
  
      // combined value (no plus sign)
      const combined = ccDigits + phoneDigits; // "91" + "7543940627" -> "917543940627"
  
      // optional: basic sanity check â€” if either part is empty, don't overwrite form
      if (!ccDigits || !phoneDigits) {
        // you can show an error, or allow submit â€” here we allow submit but do nothing
        // to show an inline error uncomment lines below:
        // e.preventDefault();
        // alert('Please select a country code and enter a valid phone number.');
        return;
      }
  
      // store original phone value in a data-* attribute in case you need it later
      phoneEl.dataset.rawPhone = rawPhone;
  
      // replace the phone input value with combined digits so backend receives it
      phoneEl.value = combined;
  
      // --- If you prefer to keep original visible phone field and send new hidden field:
      // uncomment the block below and comment out phoneEl.value = combined above.
      /*
      let hidden = document.getElementById('phone_number_full');
      if (!hidden) {
        hidden = document.createElement('input');
        hidden.type = 'hidden';
        hidden.name = 'phone_number'; // choose whichever name your backend expects
        hidden.id = 'phone_number_full';
        this.appendChild(hidden);
      }
      hidden.value = combined;
      // optionally restore phoneEl.value = rawPhone so user-visible input remains unchanged
      phoneEl.value = rawPhone;
      */
  
      // allow form to submit normally after modification
    });
  </script>
  
</body>
</html>
